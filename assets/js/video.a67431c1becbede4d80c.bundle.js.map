{"version":3,"sources":["../../assets/dev/js/frontend/handlers/video.js","../../node_modules/core-js/modules/es6.regexp.replace.js"],"names":["Video","selectors","imageOverlay","video","videoIframe","getSettings","$imageOverlay","$element","find","$video","$videoIframe","getElementSettings","apiProvider","onApiReady","apiObject","elements","remove","prepareYTVideo","playVideo","length","youtubePlayer","play","lazyLoad","data","attr","newSourceUrl","src","replace","includes","videoSrc","timeMatch","exec","slice","index","elementorFrontend","utils","lightbox","setEntranceAnimation","getCurrentDeviceSetting","setVideoAspectRatio","getModal","hide","YT","onOverlayClick","elementSettings","playerOptions","videoId","videoID","events","onReady","mute","autoplay","onStateChange","event","PlayerState","ENDED","loop","seekTo","start","playerVars","controls","rel","playsinline","play_on_mobile","modestbranding","end","yt_privacy","host","origin","window","location","hostname","Player","on","handleVideo","bind","video_type","youtube","getVideoIDFromURL","youtube_url","show_image_overlay","image_overlay","url","lazy_load","intersectionObserver","elementorModules","Scroll","scrollObserver","callback","isInViewport","unobserve","parent","observe","config","experimentalFeatures","setTimeout","propertyName","indexOf","animateVideo","isLightBoxEnabled","hideLightbox","handleAspectRatio","frontend","handlers","Base"],"mappings":"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,CAA6B,UAAEC,SAAF;AAAA,iBAAiB,MAAI,CAACG,cAAL,CAAqBH,SAArB,CAAjB;AAAA,SAA7B;AACA;AACD;;;oCAEgBkF,Y,EAAe;AAC/B,UAAK,MAAMA,YAAY,CAACC,OAAb,CAAsB,4BAAtB,CAAX,EAAkE;AACjE,aAAKC,YAAL;AAEA;AACA;;AAED,UAAMC,iBAAiB,GAAG,KAAKxF,kBAAL,CAAyB,UAAzB,CAA1B;;AAEA,UAAK,eAAeqF,YAAf,IAA+B,CAAEG,iBAAtC,EAA0D;AACzD,aAAKC,YAAL;AAEA;AACA;;AAED,UAAK,mBAAmBJ,YAAnB,IAAmCG,iBAAxC,EAA4D;AAC3D,aAAKE,iBAAL;AACA;AACD;;;EA5MiChB,gBAAgB,CAACiB,QAAjB,CAA0BC,QAA1B,CAAmCC,I;;;;;;;;;;;;;;;ACAzD;;AAEb,eAAe,mBAAO,CAAC,mEAAc;AACrC,eAAe,mBAAO,CAAC,mEAAc;AACrC,eAAe,mBAAO,CAAC,mEAAc;AACrC,gBAAgB,mBAAO,CAAC,qEAAe;AACvC,yBAAyB,mBAAO,CAAC,yFAAyB;AAC1D,iBAAiB,mBAAO,CAAC,yFAAyB;AAClD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,mBAAO,CAAC,qEAAe;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,oBAAoB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,mBAAmB;AAC1C;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,CAAC","file":"video.a67431c1becbede4d80c.bundle.js","sourcesContent":["export default class Video extends elementorModules.frontend.handlers.Base {\n\tgetDefaultSettings() {\n\t\treturn {\n\t\t\tselectors: {\n\t\t\t\timageOverlay: '.elementor-custom-embed-image-overlay',\n\t\t\t\tvideo: '.elementor-video',\n\t\t\t\tvideoIframe: '.elementor-video-iframe',\n\t\t\t},\n\t\t};\n\t}\n\n\tgetDefaultElements() {\n\t\tconst selectors = this.getSettings( 'selectors' );\n\n\t\treturn {\n\t\t\t$imageOverlay: this.$element.find( selectors.imageOverlay ),\n\t\t\t$video: this.$element.find( selectors.video ),\n\t\t\t$videoIframe: this.$element.find( selectors.videoIframe ),\n\t\t};\n\t}\n\n\thandleVideo() {\n\t\tif ( this.getElementSettings( 'lightbox' ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( 'youtube' === this.getElementSettings( 'video_type' ) ) {\n\t\t\tthis.apiProvider.onApiReady( ( apiObject ) => {\n\t\t\t\tthis.elements.$imageOverlay.remove();\n\n\t\t\t\tthis.prepareYTVideo( apiObject, true );\n\t\t\t} );\n\t\t} else {\n\t\t\tthis.elements.$imageOverlay.remove();\n\n\t\t\tthis.playVideo();\n\t\t}\n\t}\n\n\tplayVideo() {\n\t\tif ( this.elements.$video.length ) {\n\t\t\t// this.youtubePlayer exists only for YouTube videos, and its play function is different.\n\t\t\tif ( this.youtubePlayer ) {\n\t\t\t\tthis.youtubePlayer.playVideo();\n\t\t\t} else {\n\t\t\t\tthis.elements.$video[ 0 ].play();\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst $videoIframe = this.elements.$videoIframe,\n\t\t\tlazyLoad = $videoIframe.data( 'lazy-load' );\n\n\t\tif ( lazyLoad ) {\n\t\t\t$videoIframe.attr( 'src', lazyLoad );\n\t\t}\n\n\t\tconst newSourceUrl = $videoIframe[ 0 ].src.replace( '&autoplay=0', '' );\n\n\t\t$videoIframe[ 0 ].src = newSourceUrl + '&autoplay=1';\n\n\t\tif ( $videoIframe[ 0 ].src.includes( 'vimeo.com' ) ) {\n\t\t\tconst videoSrc = $videoIframe[ 0 ].src,\n\t\t\t\ttimeMatch = /#t=[^&]*/.exec( videoSrc );\n\n\t\t\t// Param '#t=' must be last in the URL\n\t\t\t$videoIframe[ 0 ].src = videoSrc.slice( 0, timeMatch.index ) + videoSrc.slice( timeMatch.index + timeMatch[ 0 ].length ) + timeMatch[ 0 ];\n\t\t}\n\t}\n\n\tasync animateVideo() {\n\t\tconst lightbox = await elementorFrontend.utils.lightbox;\n\n\t\tlightbox.setEntranceAnimation( this.getCurrentDeviceSetting( 'lightbox_content_animation' ) );\n\t}\n\n\tasync handleAspectRatio() {\n\t\tconst lightbox = await elementorFrontend.utils.lightbox;\n\n\t\tlightbox.setVideoAspectRatio( this.getElementSettings( 'aspect_ratio' ) );\n\t}\n\n\tasync hideLightbox() {\n\t\tconst lightbox = await elementorFrontend.utils.lightbox;\n\n\t\tlightbox.getModal().hide();\n\t}\n\n\tprepareYTVideo( YT, onOverlayClick ) {\n\t\tconst elementSettings = this.getElementSettings(),\n\t\t\tplayerOptions = {\n\t\t\t\tvideoId: this.videoID,\n\t\t\t\tevents: {\n\t\t\t\t\tonReady: () => {\n\t\t\t\t\t\tif ( elementSettings.mute ) {\n\t\t\t\t\t\t\tthis.youtubePlayer.mute();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( elementSettings.autoplay || onOverlayClick ) {\n\t\t\t\t\t\t\tthis.youtubePlayer.playVideo();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tonStateChange: ( event ) => {\n\t\t\t\t\t\tif ( event.data === YT.PlayerState.ENDED && elementSettings.loop ) {\n\t\t\t\t\t\t\tthis.youtubePlayer.seekTo( elementSettings.start || 0 );\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tplayerVars: {\n\t\t\t\t\tcontrols: elementSettings.controls ? 1 : 0,\n\t\t\t\t\trel: elementSettings.rel ? 1 : 0,\n\t\t\t\t\tplaysinline: elementSettings.play_on_mobile ? 1 : 0,\n\t\t\t\t\tmodestbranding: elementSettings.modestbranding ? 1 : 0,\n\t\t\t\t\tautoplay: elementSettings.autoplay ? 1 : 0,\n\t\t\t\t\tstart: elementSettings.start,\n\t\t\t\t\tend: elementSettings.end,\n\t\t\t\t},\n\t\t\t};\n\n\t\t// To handle CORS issues, when the default host is changed, the origin parameter has to be set.\n\t\tif ( elementSettings.yt_privacy ) {\n\t\t\tplayerOptions.host = 'https://www.youtube-nocookie.com';\n\t\t\tplayerOptions.origin = window.location.hostname;\n\t\t}\n\n\t\tthis.youtubePlayer = new YT.Player( this.elements.$video[ 0 ], playerOptions );\n\t}\n\n\tbindEvents() {\n\t\tthis.elements.$imageOverlay.on( 'click', this.handleVideo.bind( this ) );\n\t}\n\n\tonInit() {\n\t\tsuper.onInit();\n\n\t\tconst elementSettings = this.getElementSettings();\n\n\t\tif ( 'youtube' !== elementSettings.video_type ) {\n\t\t\t// Currently the only API integration in the Video widget is for the YT API\n\t\t\treturn;\n\t\t}\n\n\t\tthis.apiProvider = elementorFrontend.utils.youtube;\n\n\t\tthis.videoID = this.apiProvider.getVideoIDFromURL( elementSettings.youtube_url );\n\n\t\t// If there is an image overlay, the YouTube video prep method will be triggered on click\n\t\tif ( ! this.videoID ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// If the user is using an image overlay, loading the API happens on overlay click instead of on init.\n\t\tif ( elementSettings.show_image_overlay && elementSettings.image_overlay.url ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( elementSettings.lazy_load ) {\n\t\t\tthis.intersectionObserver = elementorModules.utils.Scroll.scrollObserver( {\n\t\t\t\tcallback: ( event ) => {\n\t\t\t\t\tif ( event.isInViewport ) {\n\t\t\t\t\t\tthis.intersectionObserver.unobserve( this.elements.$video.parent()[ 0 ] );\n\t\t\t\t\t\tthis.apiProvider.onApiReady( ( apiObject ) => this.prepareYTVideo( apiObject ) );\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t} );\n\n\t\t\t// We observe the parent, since the video container has a height of 0.\n\t\t\tthis.intersectionObserver.observe( this.elements.$video.parent()[ 0 ] );\n\n\t\t\treturn;\n\t\t}\n\n\t\t// When Optimized asset loading is set to off, the video type is set to 'Youtube', and 'Privacy Mode' is set\n\t\t// to 'On', there might be a conflict with other videos that are loaded WITHOUT privacy mode, such as a\n\t\t// video bBackground in a section. In these cases, to avoid the conflict, a timeout is added to postpone the\n\t\t// initialization of the Youtube API object.\n\t\tif ( ! elementorFrontend.config.experimentalFeatures[ 'e_optimized_assets_loading' ] ) {\n\t\t\tsetTimeout( () => {\n\t\t\t\tthis.apiProvider.onApiReady( ( apiObject ) => this.prepareYTVideo( apiObject ) );\n\t\t\t}, 0 );\n\t\t} else {\n\t\t\tthis.apiProvider.onApiReady( ( apiObject ) => this.prepareYTVideo( apiObject ) );\n\t\t}\n\t}\n\n\tonElementChange( propertyName ) {\n\t\tif ( 0 === propertyName.indexOf( 'lightbox_content_animation' ) ) {\n\t\t\tthis.animateVideo();\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst isLightBoxEnabled = this.getElementSettings( 'lightbox' );\n\n\t\tif ( 'lightbox' === propertyName && ! isLightBoxEnabled ) {\n\t\t\tthis.hideLightbox();\n\n\t\t\treturn;\n\t\t}\n\n\t\tif ( 'aspect_ratio' === propertyName && isLightBoxEnabled ) {\n\t\t\tthis.handleAspectRatio();\n\t\t}\n\t}\n}\n","'use strict';\n\nvar anObject = require('./_an-object');\nvar toObject = require('./_to-object');\nvar toLength = require('./_to-length');\nvar toInteger = require('./_to-integer');\nvar advanceStringIndex = require('./_advance-string-index');\nvar regExpExec = require('./_regexp-exec-abstract');\nvar max = Math.max;\nvar min = Math.min;\nvar floor = Math.floor;\nvar SUBSTITUTION_SYMBOLS = /\\$([$&`']|\\d\\d?|<[^>]*>)/g;\nvar SUBSTITUTION_SYMBOLS_NO_NAMED = /\\$([$&`']|\\d\\d?)/g;\n\nvar maybeToString = function (it) {\n  return it === undefined ? it : String(it);\n};\n\n// @@replace logic\nrequire('./_fix-re-wks')('replace', 2, function (defined, REPLACE, $replace, maybeCallNative) {\n  return [\n    // `String.prototype.replace` method\n    // https://tc39.github.io/ecma262/#sec-string.prototype.replace\n    function replace(searchValue, replaceValue) {\n      var O = defined(this);\n      var fn = searchValue == undefined ? undefined : searchValue[REPLACE];\n      return fn !== undefined\n        ? fn.call(searchValue, O, replaceValue)\n        : $replace.call(String(O), searchValue, replaceValue);\n    },\n    // `RegExp.prototype[@@replace]` method\n    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@replace\n    function (regexp, replaceValue) {\n      var res = maybeCallNative($replace, regexp, this, replaceValue);\n      if (res.done) return res.value;\n\n      var rx = anObject(regexp);\n      var S = String(this);\n      var functionalReplace = typeof replaceValue === 'function';\n      if (!functionalReplace) replaceValue = String(replaceValue);\n      var global = rx.global;\n      if (global) {\n        var fullUnicode = rx.unicode;\n        rx.lastIndex = 0;\n      }\n      var results = [];\n      while (true) {\n        var result = regExpExec(rx, S);\n        if (result === null) break;\n        results.push(result);\n        if (!global) break;\n        var matchStr = String(result[0]);\n        if (matchStr === '') rx.lastIndex = advanceStringIndex(S, toLength(rx.lastIndex), fullUnicode);\n      }\n      var accumulatedResult = '';\n      var nextSourcePosition = 0;\n      for (var i = 0; i < results.length; i++) {\n        result = results[i];\n        var matched = String(result[0]);\n        var position = max(min(toInteger(result.index), S.length), 0);\n        var captures = [];\n        // NOTE: This is equivalent to\n        //   captures = result.slice(1).map(maybeToString)\n        // but for some reason `nativeSlice.call(result, 1, result.length)` (called in\n        // the slice polyfill when slicing native arrays) \"doesn't work\" in safari 9 and\n        // causes a crash (https://pastebin.com/N21QzeQA) when trying to debug it.\n        for (var j = 1; j < result.length; j++) captures.push(maybeToString(result[j]));\n        var namedCaptures = result.groups;\n        if (functionalReplace) {\n          var replacerArgs = [matched].concat(captures, position, S);\n          if (namedCaptures !== undefined) replacerArgs.push(namedCaptures);\n          var replacement = String(replaceValue.apply(undefined, replacerArgs));\n        } else {\n          replacement = getSubstitution(matched, S, position, captures, namedCaptures, replaceValue);\n        }\n        if (position >= nextSourcePosition) {\n          accumulatedResult += S.slice(nextSourcePosition, position) + replacement;\n          nextSourcePosition = position + matched.length;\n        }\n      }\n      return accumulatedResult + S.slice(nextSourcePosition);\n    }\n  ];\n\n    // https://tc39.github.io/ecma262/#sec-getsubstitution\n  function getSubstitution(matched, str, position, captures, namedCaptures, replacement) {\n    var tailPos = position + matched.length;\n    var m = captures.length;\n    var symbols = SUBSTITUTION_SYMBOLS_NO_NAMED;\n    if (namedCaptures !== undefined) {\n      namedCaptures = toObject(namedCaptures);\n      symbols = SUBSTITUTION_SYMBOLS;\n    }\n    return $replace.call(replacement, symbols, function (match, ch) {\n      var capture;\n      switch (ch.charAt(0)) {\n        case '$': return '$';\n        case '&': return matched;\n        case '`': return str.slice(0, position);\n        case \"'\": return str.slice(tailPos);\n        case '<':\n          capture = namedCaptures[ch.slice(1, -1)];\n          break;\n        default: // \\d\\d?\n          var n = +ch;\n          if (n === 0) return match;\n          if (n > m) {\n            var f = floor(n / 10);\n            if (f === 0) return match;\n            if (f <= m) return captures[f - 1] === undefined ? ch.charAt(1) : captures[f - 1] + ch.charAt(1);\n            return match;\n          }\n          capture = captures[n - 1];\n      }\n      return capture === undefined ? '' : capture;\n    });\n  }\n});\n"],"sourceRoot":""}